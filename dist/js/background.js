"use strict";function openSettingPage(){chrome.runtime.openOptionsPage()}class _Config{constructor(){this.storage="undefined"==typeof browser?chrome.storage.sync:browser.storage.sync,this.storageName="config",this.buffer={};const a=this;this.storage.get(this.storageName,b=>{b[a.storageName]&&(a.buffer=b[a.storageName])})}save(a,b,c){this.buffer[a]=b;const d={};d[this.storageName]=this.buffer,this.storage.set(d,()=>{c(b)})}load(a,b){if(this.buffer[a]!==void 0)b(this.buffer[a]);else{const c=this.storageName;this.storage.get(c,d=>{"function"!=typeof b||(d&&d[c]?b(d[c][a]):b(null))})}}remove(a,b){if(this.buffer[a]!==void 0){delete this.buffer[a];const c={};c[this.storageName]=this.buffer,this.storage.set(c,()=>{b(!0)})}else b(!1)}}const Config=new _Config;chrome.runtime.onMessage.addListener(function(a,b,c){switch(a.action){case"openSettingPage":openSettingPage();break;case"config.save":Config.save(a.data.key,a.data.value,c);break;case"config.load":Config.load(a.data.key,c);break;case"config.remove":Config.remove(a.data.key,c);break;default:}return!0});